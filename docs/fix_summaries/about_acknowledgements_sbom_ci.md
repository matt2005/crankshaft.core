# About Page Enhancements: Acknowledgements, SBOM, and CI/CD

## Overview
Enhanced the About page with comprehensive third-party acknowledgements, SBOM (Software Bill of Materials) generation, and multi-architecture CI/CD pipelines for Debian package building.

## Changes Made

### 1. Settings UI Components (`ui/qml/screens/SettingsScreen.qml`)
Added two new setting types to support the enhanced About page:

#### Link Setting Component
- **Purpose**: Display clickable links that open in external browser
- **Features**:
  - Clickable rectangular area with hover cursor
  - Primary-coloured link text with underline
  - External link icon (`mdi-open-in-new`)
  - Label, description, and link text support
  - Opens URLs using `Qt.openUrlExternally()`
- **Properties Used**:
  - `setting.label`: Main text
  - `setting.description`: Optional description
  - `setting.value`: The URL to open
  - `setting.linkText`: Display text for the link

#### Header Setting Component
- **Purpose**: Display section headers within settings
- **Features**:
  - Large, bold text (Theme.fontSizeHeading3)
  - Extra vertical spacing
  - No background or borders
- **Properties Used**:
  - `setting.label`: Header text

#### Integration
Updated the delegate switch statement to handle:
- `case "link": return linkSetting`
- `case "header": return headerSetting`

### 2. About Section in Settings Model (`ui/qml/models/SettingsModel.qml`)
Expanded the About category with comprehensive information:

#### System Information
- **Version**: Application version with commit SHA
- **License**: GPL-3.0-or-later with link
- **Website**: Project website link

#### SBOM Link
- Download link to CycloneDX SBOM JSON file
- Generated by CI/CD pipeline
- Available with each release

#### Third-Party Acknowledgements
Added detailed acknowledgements for all major dependencies:

1. **Qt6**
   - License: LGPL-3.0 / GPL-3.0 / Commercial
   - Website: https://www.qt.io

2. **AASDK (Android Auto SDK)**
   - License: MIT
   - Website: https://github.com/opencardev/aasdk

3. **Protocol Buffers**
   - License: BSD-3-Clause
   - Website: https://protobuf.dev

4. **Boost C++ Libraries**
   - License: Boost Software License 1.0
   - Website: https://www.boost.org

5. **OpenSSL**
   - License: Apache-2.0
   - Website: https://www.openssl.org

6. **Material Design Icons**
   - License: Apache-2.0
   - Website: https://pictogrammers.com/library/mdi/

7. **Contributors**
   - Acknowledgement of GitHub contributors

### 3. GitHub Actions CI/CD Workflows

#### Build Workflow (`.github/workflows/build.yml`)
Comprehensive multi-architecture build pipeline:

**Trigger Events**:
- Push to main/develop branches
- Pull requests to main/develop
- Manual workflow dispatch
- Called by release workflow

**Architecture Support**:
- `amd64`: Standard x86-64
- `arm64`: 64-bit ARM (Raspberry Pi 4, etc.)
- `armhf`: 32-bit ARM (legacy Raspberry Pi)

**Build Process**:
1. Generate build matrix from architecture list
2. Set up Docker Buildx for multi-platform builds
3. Build Debian package using `docker/Dockerfile.build`
4. Extract DEB package from Docker image
5. Generate SBOM using multiple tools:
   - **CycloneDX CLI**: Generates base SBOM with components
   - **syft**: Scans package for dependencies
   - Merges outputs into comprehensive CycloneDX JSON
6. Upload artifacts:
   - `crankshaft-{arch}.deb`: Debian packages
   - `sbom-cyclonedx.json`: Combined SBOM

**SBOM Components Included**:
- Qt6 (LGPL-3.0)
- AASDK (MIT)
- Protocol Buffers (BSD-3-Clause)
- Boost (BSL-1.0)
- OpenSSL (Apache-2.0)
- libusb (LGPL-2.1)

#### Release Workflow (`.github/workflows/release.yml`)
Automated release publication:

**Trigger Events**:
- Push of version tags (v*.*.*)
- Manual workflow dispatch

**Process**:
1. Call build workflow to generate all artifacts
2. Download built DEB packages and SBOM
3. Generate changelog from commits since last tag
4. Create GitHub Release with:
   - Version tag
   - Generated release notes
   - All architecture DEB packages
   - CycloneDX SBOM JSON
5. Optionally create draft releases for review

### 4. Docker Build Configuration (`docker/Dockerfile.build`)
Multi-architecture Debian package builder:

**Base Image**: `debian:bookworm`

**Build Arguments**:
- `TARGETARCH`: Architecture (amd64/arm64/arm)
- `VERSION`: Application version for DEB package

**Installed Dependencies**:
- Qt6 (Base, Declarative, WebSockets, Network)
- Build tools (CMake, GCC, G++)
- AASDK and dependencies (Protobuf, Boost, OpenSSL, libusb)

**Build Process**:
1. **Stage 1**: Build application with CMake
   - Configure with tests enabled
   - Build with all cores (`-j`)
   - Run test suite
2. **Stage 2**: Package creation
   - Create proper Debian directory structure
   - Generate control file with dependencies
   - Build DEB package with `dpkg-deb`
   - Export to `/output` directory

**Generated Package**:
- Name: `crankshaft_{VERSION}_{ARCH}.deb`
- Dependencies: Qt6 libraries, AASDK dependencies
- Architecture: amd64/arm64/armhf

## File Structure
```
.github/workflows/
├── build.yml          # Main CI/CD pipeline (451 lines)
└── release.yml        # Release automation (198 lines)

docker/
└── Dockerfile.build   # Multi-arch package builder

ui/qml/
├── screens/
│   └── SettingsScreen.qml  # Added link and header components
└── models/
    └── SettingsModel.qml   # Enhanced About section
```

## Benefits

### For Users
- **Transparency**: Complete visibility of all third-party components
- **License Compliance**: Clear licensing information for all dependencies
- **Easy Access**: One-click links to dependency websites and licenses
- **SBOM Availability**: Downloadable software bill of materials for security audits

### For Developers
- **Automated Builds**: Multi-architecture builds with single workflow
- **Quality Assurance**: Automated testing before packaging
- **Release Automation**: One-click releases with all artifacts
- **SBOM Generation**: Automatic creation of security-compliant SBOM
- **Dependency Tracking**: Clear dependency chain documentation

### For Security
- **Vulnerability Scanning**: SBOM enables automated security scanning
- **License Compliance**: Clear license attribution for all components
- **Audit Trail**: Version tracking for all dependencies
- **Supply Chain Security**: Transparent build process with artifact signatures

## Usage

### Building Packages Locally
```bash
# Build for specific architecture
docker build -f docker/Dockerfile.build \
  --build-arg TARGETARCH=amd64 \
  --build-arg VERSION=1.0.0 \
  --output output \
  .
```

### Triggering CI/CD
```bash
# Automatic trigger on push to main/develop
git push origin main

# Manual trigger via GitHub Actions UI
# Go to Actions → Build → Run workflow

# Create release
git tag v1.0.0
git push origin v1.0.0
```

### Accessing SBOM
- Download from GitHub Release assets: `sbom-cyclonedx.json`
- View in About section: Settings → About → SBOM link
- Import into security tools (Dependency-Track, Grype, etc.)

## Standards Compliance

### CycloneDX
- **Version**: 1.4+
- **Format**: JSON
- **Components**: All direct and transitive dependencies
- **Metadata**: Licenses, versions, suppliers
- **Tools**: Generated with CycloneDX CLI and syft

### SPDX
- License identifiers follow SPDX standard
- Example: `GPL-3.0-or-later`, `MIT`, `Apache-2.0`

### Debian Packaging
- **Policy**: Follows Debian Policy Manual
- **Control Fields**: Package, Version, Architecture, Depends, Description
- **Directory Structure**: `/usr/bin`, `/usr/share`, `/etc`

## Future Enhancements

### Potential Improvements
1. **Digital Signatures**: Sign DEB packages with GPG keys
2. **Repository**: Host packages in APT repository
3. **Vulnerability Scanning**: Integrate Grype/Trivy in CI
4. **License Scanning**: Automated license compatibility checking
5. **Dependency Updates**: Automated dependency update PRs
6. **Multi-Format SBOM**: Generate both CycloneDX and SPDX formats
7. **Web Viewer**: HTML SBOM viewer for easier browsing
8. **Provenance**: SLSA provenance attestation for builds

### Extension Support
1. **Extension SBOM**: Generate SBOM for each extension
2. **Extension Store**: Display acknowledgements in extension store
3. **Aggregate SBOM**: Combine core + extension SBOMs
4. **License Scanner**: Validate extension licenses before installation

## Testing Recommendations

### UI Testing
1. Navigate to Settings → About
2. Verify all acknowledgement sections display correctly
3. Click each link to verify external browser opens
4. Check SBOM link downloads correct file
5. Verify header formatting (bold, larger text)
6. Test light and dark mode appearance

### Build Testing
1. Trigger build workflow for all architectures
2. Verify DEB packages are created successfully
3. Validate SBOM contains all expected components
4. Install DEB package on target system
5. Verify application runs correctly
6. Check dependency resolution

### Release Testing
1. Create test tag
2. Verify release workflow triggers
3. Check release assets include all DEB files and SBOM
4. Verify release notes generate correctly
5. Download and test packages from release

## References

### Documentation
- [CycloneDX Specification](https://cyclonedx.org/specification/overview/)
- [Debian Policy Manual](https://www.debian.org/doc/debian-policy/)
- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Docker Buildx Documentation](https://docs.docker.com/buildx/working-with-buildx/)

### Tools
- [CycloneDX CLI](https://github.com/CycloneDX/cyclonedx-cli)
- [syft](https://github.com/anchore/syft)
- [Qt6](https://doc.qt.io/qt-6/)
- [AASDK](https://github.com/opencardev/aasdk)

## License
All code follows the project's GPL-3.0-or-later license. Third-party components retain their original licenses as documented in the acknowledgements section.
